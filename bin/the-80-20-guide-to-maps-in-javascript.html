<html><head><script type="text/javascript">var _sf_startpt=(new Date()).getTime()
</script><title>The 80/20 Guide to Maps in JavaScript | www.thecodebarbarian.com</title><meta name="viewport" content="width=device-width, initial-scale=1"/><link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" type="text/css"/><link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600" rel="stylesheet" type="text/css"/><link href="//fonts.googleapis.com/css?family=Merriweather:400,400italic,600,700" rel="stylesheet" type="text/css"/><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/><link href="/style/style.css" rel="stylesheet" type="text/css"/><link href="/style/github.css" rel="stylesheet" type="text/css"/><script href="http://code.jquery.com/jquery-2.1.1.min.js" type="text/javascript"></script><script href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js" type="text/javascript"></script><script href="/javascript/sidebar.js" type="text/javascript"></script><meta property="og:title" content="The 80/20 Guide to Maps in JavaScript"/><meta property="og:url" content="http://www.thecodebarbarian.com/the-80-20-guide-to-maps-in-javascript"/><meta property="og:image" content="https://codebarbarian-images.s3.amazonaws.com/201909_globe.jpeg"/><meta property="og:site_name" content="The Code Barbarian"/></head><body><div class="navbar social-links hidden-sm hidden-xs"><div class="container"><ul class="nav navbar-nav navbar-right"><li><a href="http://www.twitter.com/code_barbarian">twitter</a></li><li><a href="http://www.github.com/vkarpov15">github</a></li><li><a href="http://thecodebarbarian.com/feed.xml">rss</a></li><li><a href="/recommendations">recommendations</a></li></ul></div></div><div id="nav" class="navbar"><div class="container"><div class="navbar-header"><a href="http://thecodebarbarian.com" class="navbar-brand big-brand"><img src="/images/Barbarian_Head.png" class="logo"/><span class="site-name">The Code Barbarian</span></a></div><div id="home-nav-mobile" class="navbar-right collapse navbar-collapse"><ul class="nav navbar-nav"><li><a href="/tag/mongodb.html">MongoDB</a></li><li><a href="/tag/nodejs.html">NodeJS</a></li><li><a href="/tag/asyncawait.html">Async/Await</a></li><li><a href="/tag/vue.html">Vue</a></li><li class="hidden-md hidden-lg"><a href="#">@code_barbarian</a></li><li class="hidden-md hidden-lg"><a href="#">TCB Github</a></li><li class="hidden-md hidden-lg"><a href="#">TCB Facebook</a></li></ul></div></div></div><div class="container-fluid"><div id="desktop-right-bar" class="col-lg-3 col-lg-offset-9 right-bar"><div class="right-bar-content-slider pull-right"><div class="row recent-posts right-bar-group"><div class="col-lg-12 articles"><p class="right-bar-label">Most Popular Articles</p><ul class="list-unstyled"><li class="right-bar-li"><a href="/common-async-await-design-patterns-in-node.js.html">Common Async/Await Design Patterns in Node.js</a></li><li class="right-bar-li"><a href="/unhandled-promise-rejections-in-node.js.html">Unhandled Promise Rejections in Node.js</a></li><li class="right-bar-li"><a href="/using-async-await-with-mocha-express-and-mongoose">Using Async/Await with Mocha, Express, and Mongoose</a></li><li class="right-bar-li"><a href="/write-your-own-node-js-promise-library-from-scratch.html">Write Your Own Node.js Promise Library from Scratch</a></li><li class="right-bar-li"><a href="/80-20-guide-to-express-error-handling">The 80/20 Guide to Express Error Handling</a></li></ul></div></div><div class="row recent-posts right-bar-group"><div class="col-lg-12 books"><p class="right-bar-label">Ebooks<div><a href="http://asyncawait.net/?utm_source=thecodebarbarian&amp;utm_campaign=sidebar"><img src="/images/verticalbanner.png"/></a></div><div><a href="http://es2015generators.com"><img src="https://i.imgur.com/xvGNKlr.png"/><p><i>The 80/20 Guide to ES2015 Generators</i></p></a></div><div><script type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&amp;serve=C6AILKT&amp;placement=thecodebarbariancom" id="_carbonads_js"></script></div></p></div></div></div></div></div><div id="mobile-sharing-options" class="container-fluid hidden-sm hidden-md hidden-lg"><div class="row"><div class="col-lg-12"><style>#home-nav-mobile {
  float: left !important;
  margin-left: 215px !important;
}
</style><div class="post-sharing-options"><div class="row"><div class="col-xs-3 twitter-share sharing-option"><a href="https://twitter.com/share?url=http%3A%2F%2Fwww.thecodebarbarian.com%2Fthe-80-20-guide-to-maps-in-javascript&amp;via=code_barbarian" class="social"><i class="fa fa-twitter"></i></a></div><div class="col-xs-3 facebook-share sharing-option"><a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.thecodebarbarian.com%2F%2Fthe-80-20-guide-to-maps-in-javascript" class="social"><i class="fa fa-facebook"></i></a></div><div class="col-xs-3 google-share sharing-option"><a href="https://plus.google.com/share?url=http%3A%2F%2Fwww.thecodebarbarian.com%2F%2Fthe-80-20-guide-to-maps-in-javascript" class="social"><i class="fa fa-google-plus"></i></a></div><div class="col-xs-3 comment sharing-option"><a href="#disqus_thread" class="social"><i class="fa fa-comment"></i></a></div></div></div></div></div></div><div id="desktop-sharing-options" class="post-sharing-options hidden-xs pull-left"><ul class="list-unstyled"><li class="twitter-share"><a href="https://twitter.com/share?url=http%3A%2F%2Fwww.thecodebarbarian.com%2Fthe-80-20-guide-to-maps-in-javascript&amp;via=code_barbarian" class="social"><i class="fa fa-twitter sharing-option"></i></a></li><li class="facebook-share"><a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.thecodebarbarian.com%2F%2Fthe-80-20-guide-to-maps-in-javascript" class="social"><i class="fa fa-facebook sharing-option"></i></a></li><li class="google-share"><a href="https://plus.google.com/share?url=http%3A%2F%2Fwww.thecodebarbarian.com%2F%2Fthe-80-20-guide-to-maps-in-javascript" class="social"><i class="fa fa-google-plus sharing-option"></i></a></li></ul></div><div class="container"><div class="col-lg-9 post-text"><div class="row"><div class="title-byline-container"><h1 class="post-title">The 80/20 Guide to Maps in JavaScript</h1><div class="credits"><span class="byline">by Valeri Karpov</span><span class="byhandle"><a href="http://www.twitter.com/code_barbarian">@code_barbarian</a></span><span class="bydate">September 18, 2019</span></div></div></div><script type="text/javascript" src="/js/native.js"></script><div><script>
  _native.init("CK7DT53N",{
    targetClass: 'native-inline'
  });
</script>

<div class="native-inline">
  <a href="#native_link#"><span class="sponsor">Sponsor</span> #native_company# - #native_desc#</a>
</div>
</div><div class="post-body-text-container"><p>In JavaScript, a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map">Map</a> is an object that stores key/value pairs. Maps are
similar to <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">general JavaScript objects</a>, but there are a few key <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map#Objects_and_maps_compared">differences between objects and maps</a> that make maps useful.</p>
<h2 id="maps-vs-objects">Maps vs Objects</h2>
<p>Suppose you want to create a JavaScript object that stores some
key/value paths. You could define a plain-old JavaScript object,
or a &quot;POJO&quot; for short, as shown below.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> obj = {
  name: <span class="hljs-string">'Jean-Luc Picard'</span>,
  age: <span class="hljs-number">59</span>,
  rank: <span class="hljs-string">'Captain'</span>
};

obj.name; <span class="hljs-comment">// 'Jean-Luc Picard'</span>
</code></pre>
<p>You could also define a map that contains the same keys and values as shown below.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>([
  <span class="hljs-comment">// You define a map via an array of 2-element arrays. The first</span>
  <span class="hljs-comment">// element of each nested array is the key, and the 2nd is the value</span>
  [<span class="hljs-string">'name'</span>, <span class="hljs-string">'Jean-Luc Picard'</span>],
  [<span class="hljs-string">'age'</span>, <span class="hljs-number">59</span>],
  [<span class="hljs-string">'rank'</span>, <span class="hljs-string">'Captain'</span>]
]);

<span class="hljs-comment">// To get the value associated with a given `key` in a map, you</span>
<span class="hljs-comment">// need to call `map.get(key)`. Using `map.key` will **not** work.</span>
map.get(<span class="hljs-string">'name'</span>); <span class="hljs-comment">// 'Jean-Luc Picard'</span>
</code></pre>
<p>Suppose you wanted to get Captain Picard&#39;s <code>age</code>. With an object,
you can use <code>obj.age</code>. With a map, you would use <code>map.get(&#39;age&#39;)</code>.
That works fine for properties that don&#39;t conflict with built-in
JavaScript functionality, but what about if you wanted to get the
object&#39;s <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/constructor"><code>constructor</code> property</a>? In this case, <code>obj.constructor</code>
is defined, but <code>map.get(&#39;constructor&#39;)</code> is not.</p>
<pre><code class="lang-javascript">obj.constructor; <span class="hljs-comment">// [Function: Object]</span>
map.get(<span class="hljs-string">'constructor'</span>); <span class="hljs-comment">// undefined</span>
</code></pre>
<p>With JavaScript objects, you could use
<code>Object.create(null)</code> to create an object
that doesn&#39;t inherit from any class, and
so doesn&#39;t have a <code>constructor</code> property.
That is one approach to the issue of separating
user data from program data: maps are another.</p>
<p>Maps don&#39;t have any notion of <a href="https://masteringjs.io/tutorials/fundamentals/prototype">inheritance</a>: a map does not have any inherited keys. This makes maps ideal for storing raw
data without worrying about that data conflicting with existing
methods and properties. For example, maps are immune to <a href="https://snyk.io/blog/after-three-years-of-silence-a-new-jquery-prototype-pollution-vulnerability-emerges-once-again/">prototype pollution</a>, a security vulnerability where naive copying of user data can allow a malicious user to overwrite class methods.</p>
<p>Another key difference is that maps allow you to store object keys,
not just strings. This can cause some confusion when you&#39;re storing
objects like Dates or Numbers as keys.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>([]);

<span class="hljs-keyword">const</span> n1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Number</span>(<span class="hljs-number">5</span>);
<span class="hljs-keyword">const</span> n2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Number</span>(<span class="hljs-number">5</span>);

map.set(n1, <span class="hljs-string">'One'</span>);
map.set(n2, <span class="hljs-string">'Two'</span>);

<span class="hljs-comment">// `n1` and `n2` are objects, so `n1 !== n2`. That means the map has</span>
<span class="hljs-comment">// separate keys for `n1` and `n2`.</span>
map.get(n1); <span class="hljs-comment">// 'One'</span>
map.get(n2); <span class="hljs-comment">// 'Two'</span>
map.get(<span class="hljs-number">5</span>); <span class="hljs-comment">// undefined</span>

<span class="hljs-comment">// If you were to do this with an object, `n2` would overwrite `n1`</span>
<span class="hljs-keyword">const</span> obj = {};
obj[n1] = <span class="hljs-string">'One'</span>;
obj[n2] = <span class="hljs-string">'Two'</span>;

obj[n1]; <span class="hljs-comment">// 'Two'</span>
obj[<span class="hljs-number">5</span>]; <span class="hljs-comment">// 'Two'</span>
</code></pre>
<p>Maps also have a <code>size</code> property that returns the number of key/value 
pairs in the map. To get the number of keys in an object, you would
have to do <code>Object.keys(obj).length</code>.</p>
<pre><code class="lang-javascript">map.size; <span class="hljs-comment">// 3</span>
</code></pre>
<p>Another difference you&#39;ll likely read about is the order of the keys
in a map is guaranteed. In other words, if you call <code>map.keys()</code>, you 
will <em>always</em> get the keys in the order in which they were added to
the map. In the Captain Picard example, <code>map.keys()</code> will always
return <code>name</code>, <code>age</code>, and <code>rank</code> in that order.</p>
<p><a href="https://www.stefanjudis.com/today-i-learned/property-order-is-predictable-in-javascript-objects-since-es2015/">Object key order is also guaranteed for ES6-compliant browsers</a>. For example, <code>Object.keys(obj)</code> will always return
<code>[&#39;name&#39;, &#39;age&#39;, &#39;rank&#39;]</code> in ES6-compliant JavaScript runtimes. But,
in older runtimes (Internet Explorer, etc.) <code>Object.keys(obj)</code> may
return the keys in a different order.</p>
<h2 id="-map-keys-map-values-map-entries-"><code>Map#keys()</code>, <code>Map#values()</code>, <code>Map#entries()</code></h2>
<p>Maps have 3 built-in methods for iterating through the map: <code>keys()</code>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map/values"><code>values()</code></a>, and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map/entries"><code>entries()</code></a>. Unlike <code>Object.keys()</code>, the <code>Map#keys()</code> function returns an <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Iterators_and_Generators">iterator</a>, not an array. That means the easiest way to
iterate a map&#39;s keys is using a <a href="/for-vs-for-each-vs-for-in-vs-for-of-in-javascript"><code>for/of</code> loop</a>.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>([
  [<span class="hljs-string">'name'</span>, <span class="hljs-string">'Jean-Luc Picard'</span>],
  [<span class="hljs-string">'age'</span>, <span class="hljs-number">59</span>],
  [<span class="hljs-string">'rank'</span>, <span class="hljs-string">'Captain'</span>]
]);

<span class="hljs-keyword">const</span> iterator = map.keys();
<span class="hljs-built_in">console</span>.log(iterator); <span class="hljs-comment">// MapIterator { 'name', 'age', 'rank' }</span>

<span class="hljs-comment">// `map.keys()` returns an iterator, not an array, so you can't</span>
<span class="hljs-comment">// access the values using `[]`</span>
iterator[<span class="hljs-number">0</span>]; <span class="hljs-comment">// undefined</span>

<span class="hljs-comment">// The `for/of` loop can loop through iterators</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">of</span> map.keys()) {
  key; <span class="hljs-comment">// 'name', 'age', 'rank'</span>
}
</code></pre>
<p>Sometimes it is handy to convert an iterator into an array so you
can use array methods like <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter"><code>filter()</code></a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map"><code>map()</code></a>. The easiest way to convert an iterator into an array is using <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/from">the built-in <code>Array.from()</code> function</a>.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> arr = <span class="hljs-built_in">Array</span>.from(map.keys());

arr.length; <span class="hljs-comment">// 3</span>
arr[<span class="hljs-number">0</span>]; <span class="hljs-comment">// 'name'</span>
arr[<span class="hljs-number">1</span>]; <span class="hljs-comment">// 'age'</span>
arr[<span class="hljs-number">2</span>]; <span class="hljs-comment">// 'rank'</span>
</code></pre>
<p>The <code>Map#values()</code> function also returns an iterator. The iterator
iterates through the map&#39;s values:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> v <span class="hljs-keyword">of</span> map.values()) {
  v; <span class="hljs-comment">// 'Jean-Luc Picard', 59, 'Captain'</span>
}
</code></pre>
<p>Finally, <code>Map#entries()</code> returns an iterator that iterates through
the map&#39;s key/value pairs in a similar format to the <code>Map</code> 
constructor. The <code>Map#entries()</code> function is the <code>Map</code> class&#39;s
equivalent to <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/entries"><code>Object.entries()</code></a>.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> map.entries()) {
  key; <span class="hljs-comment">// 'name', 'age', 'rank'</span>
  value; <span class="hljs-comment">// 'Jean-Luc Picard', 59, 'Captain'</span>
}
</code></pre>
<p>The <code>Map#entries()</code> function makes it easy to copy a map. Cloning
a map is as simple as converting <code>map.entries()</code> into an array:</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// `clone` is now a separate map that contains the same keys/values</span>
<span class="hljs-comment">// as `map`.</span>
<span class="hljs-keyword">const</span> clone = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>(<span class="hljs-built_in">Array</span>.from(map.entries()));
</code></pre>
<h2 id="moving-on">Moving On</h2>
<p>Although JavaScript developers typically use objects to store user
data, maps have some advantages: there&#39;s no risk of prototype
pollution or JSON data overwriting class methods. Maps also let
you store object keys, which can be useful if you want to associate
data with an object without setting a <a href="a-practical-guide-to-symbols-in-javascript.html">symbol</a>. Maps are still
pretty uncommon in open source JavaScript, the only significant
use case I&#39;ve seen is <a href="https://thecodebarbarian.com/whats-new-in-mongoose-5.1-map-support.html">Mongoose&#39;s map type</a>. But maps are worth experimenting with for representing JSON
data because they avoid the risk of prototype pollution.</p>
</div><div style="color: #666666; border-top: 1px dashed #666666; margin: 25px; text-align: center; padding-top: 10px"><em>Found a typo or error? Open up a pull request! This post is
available as markdown on&nbsp;<a href="https://github.com/vkarpov15/thecodebarbarian.com/blob/master/lib/posts/20190918_javascript_map.md">Github</a></em></div><div id="disqus_thread"></div><script type="text/javascript">/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'codebarbarian'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></div></div><div style="padding-bottom: 100px">&nbsp;</div><script type="text/javascript">var xhr = new XMLHttpRequest();
xhr.open('POST', 'https://g0a3nbw0xa.execute-api.us-east-1.amazonaws.com/prod/track', true);
xhr.setRequestHeader('Content-Type', 'application/json');
xhr.onreadystatechange = function() {};
xhr.send(JSON.stringify({
  path: window.location.pathname,
  hostname: window.location.hostname
}));</script><link rel="stylesheet" href="/style/inlinecpc.css"/></body></html>