<html><head><script type="text/javascript">var _sf_startpt=(new Date()).getTime()
</script><title>String Replace in JavaScript | www.thecodebarbarian.com</title><meta name="viewport" content="width=device-width, initial-scale=1"/><link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" type="text/css"/><link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600" rel="stylesheet" type="text/css"/><link href="//fonts.googleapis.com/css?family=Merriweather:400,400italic,600,700" rel="stylesheet" type="text/css"/><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/><link href="/style/style.css" rel="stylesheet" type="text/css"/><link href="/style/github.css" rel="stylesheet" type="text/css"/><script href="http://code.jquery.com/jquery-2.1.1.min.js" type="text/javascript"></script><script href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js" type="text/javascript"></script><script href="/javascript/sidebar.js" type="text/javascript"></script><meta property="og:title" content="#{post.title}"/><meta property="og:url" content="http://www.thecodebarbarian.com#{post.dest.directory.substr('./bin'.length)}/#{post.dest.name}"/><meta property="og:image" content="#{post.image || '/images/Barbarian_Head.png'}"/><meta property="og:site_name" content="The Code Barbarian"/></head><body><div class="navbar social-links hidden-sm hidden-xs"><div class="container"><ul class="nav navbar-nav navbar-right"><li><a href="http://www.twitter.com/code_barbarian">twitter</a></li><li><a href="http://www.github.com/vkarpov15">github</a></li><li><a href="http://thecodebarbarian.com/feed.xml">rss</a></li><li><a href="/recommendations">recommendations</a></li></ul></div></div><div class="navbar" id="nav"><div class="container"><div class="navbar-header"><a class="navbar-brand big-brand" href="http://thecodebarbarian.com"><img class="logo" src="/images/Barbarian_Head.png"/><span class="site-name">The Code Barbarian</span></a></div><div class="navbar-right collapse navbar-collapse" id="home-nav-mobile"><ul class="nav navbar-nav"><li><a href="/tag/mongodb.html">MongoDB</a></li><li><a href="/tag/nodejs.html">NodeJS</a></li><li><a href="/tag/asyncawait.html">Async/Await</a></li><li><a href="/tag/vue.html">Vue</a></li><li class="hidden-md hidden-lg"><a href="#">@code_barbarian</a></li><li class="hidden-md hidden-lg"><a href="#">TCB Github</a></li><li class="hidden-md hidden-lg"><a href="#">TCB Facebook</a></li></ul></div></div></div><div class="container-fluid"><div class="col-lg-3 col-lg-offset-9 right-bar" id="desktop-right-bar"><div class="right-bar-content-slider pull-right"><div class="row recent-posts right-bar-group"><div class="col-lg-12 articles"><p class="right-bar-label">Most Popular Articles</p><ul class="list-unstyled"><li class="right-bar-li"><a href="/common-async-await-design-patterns-in-node.js.html">Common Async/Await Design Patterns in Node.js</a></li><li class="right-bar-li"><a href="/unhandled-promise-rejections-in-node.js.html">Unhandled Promise Rejections in Node.js</a></li><li class="right-bar-li"><a href="/using-async-await-with-mocha-express-and-mongoose">Using Async/Await with Mocha, Express, and Mongoose</a></li><li class="right-bar-li"><a href="/write-your-own-node-js-promise-library-from-scratch.html">Write Your Own Node.js Promise Library from Scratch</a></li><li class="right-bar-li"><a href="/80-20-guide-to-express-error-handling">The 80/20 Guide to Express Error Handling</a></li></ul></div></div><div class="row recent-posts right-bar-group"><div class="col-lg-12 books"><p class="right-bar-label">Ebooks<div><a href="http://asyncawait.net/?utm_source=thecodebarbarian&amp;utm_campaign=sidebar"><img src="/images/verticalbanner.png"/></a></div><div><a href="http://es2015generators.com"><img src="https://i.imgur.com/xvGNKlr.png"/><p><i>The 80/20 Guide to ES2015 Generators</i></p></a></div><div><script type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&amp;serve=C6AILKT&amp;placement=thecodebarbariancom" id="_carbonads_js"></script></div></p></div></div></div></div></div><div class="container-fluid hidden-sm hidden-md hidden-lg" id="mobile-sharing-options"><div class="row"><div class="col-lg-12"><style>#home-nav-mobile {
  float: left !important;
  margin-left: 215px !important;
}
</style><div class="post-sharing-options"><div class="row"><div class="col-xs-3 twitter-share sharing-option"><a class="social" href="https://twitter.com/share?url=#{encodeURIComponent('http://www.thecodebarbarian.com' + post.dest.directory.substr('./bin'.length) + '/' + post.dest.name)}&amp;via=code_barbarian"><i class="fa fa-twitter"></i></a></div><div class="col-xs-3 facebook-share sharing-option"><a class="social" href="https://www.facebook.com/sharer/sharer.php?u=#{encodeURIComponent('http://www.thecodebarbarian.com/' + post.dest.directory.substr('./bin'.length) + '/' + post.dest.name)}"><i class="fa fa-facebook"></i></a></div><div class="col-xs-3 google-share sharing-option"><a class="social" href="https://plus.google.com/share?url=#{encodeURIComponent('http://www.thecodebarbarian.com/' + post.dest.directory.substr('./bin'.length) + '/' + post.dest.name)}"><i class="fa fa-google-plus"></i></a></div><div class="col-xs-3 comment sharing-option"><a class="social" href="#disqus_thread"><i class="fa fa-comment"></i></a></div></div></div></div></div></div><div class="post-sharing-options hidden-xs pull-left" id="desktop-sharing-options"><ul class="list-unstyled"><li class="twitter-share"><a class="social" href="https://twitter.com/share?url=#{encodeURIComponent('http://www.thecodebarbarian.com' + post.dest.directory.substr('./bin'.length) + '/' + post.dest.name)}&amp;via=code_barbarian"><i class="fa fa-twitter sharing-option"></i></a></li><li class="facebook-share"><a class="social" href="https://www.facebook.com/sharer/sharer.php?u=#{encodeURIComponent('http://www.thecodebarbarian.com/' + post.dest.directory.substr('./bin'.length) + '/' + post.dest.name)}"><i class="fa fa-facebook sharing-option"></i></a></li><li class="google-share"><a class="social" href="https://plus.google.com/share?url=#{encodeURIComponent('http://www.thecodebarbarian.com/' + post.dest.directory.substr('./bin'.length) + '/' + post.dest.name)}"><i class="fa fa-google-plus sharing-option"></i></a></li></ul></div><div class="container"><div class="col-lg-9 post-text"><div class="row"><div class="title-byline-container"><h1 class="post-title">String Replace in JavaScript</h1><div class="credits"><span class="byline">by Valeri Karpov</span><span class="byhandle"><a href="http://www.twitter.com/code_barbarian">@code_barbarian</a></span><span class="bydate">March 21, 2019</span></div></div></div><script type="text/javascript" src="/js/native.js"></script><div><script>
  _native.init("CK7DT53N",{
    targetClass: 'native-inline'
  });
</script>

<div class="native-inline">
  <a href="#native_link#"><span class="sponsor">Sponsor</span> #native_company# - #native_desc#</a>
</div>
</div><div class="post-body-text-container"><p>The <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace"><code>String#replace()</code></a> function replaces instances of a substring with another substring, and returns the modified string. This function seems simple at first, but <code>String#replace()</code> can do a whole lot more than just replace &#39;foo&#39; with &#39;bar&#39;. In this article, I&#39;ll explain some more sophisticated ways to use <code>String#replace()</code>, and highlight some common pitfalls to avoid.</p>
<h2 id="the-basics-of-replacing-a-string">The Basics of Replacing a String</h2>
<p><a href="https://www.sitepoint.com/immutability-javascript/">JavaScript strings are immutable</a>,
so the <code>String#replace()</code> function returns the modified string. It does <strong>not</strong> modify
the existing string.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> str1 = <span class="hljs-string">'foo bar'</span>;
<span class="hljs-keyword">const</span> str2 = str1.replace(<span class="hljs-string">'foo'</span>, <span class="hljs-string">'bar'</span>);

str1; <span class="hljs-comment">// 'foo bar'</span>
str2; <span class="hljs-comment">// 'bar bar'</span>
</code></pre>
<p>Generally, the first argument to <code>replace()</code> is called the <em>pattern</em>, and the 2nd
argument is called the <em>replacement</em>. In the above example, &#39;foo&#39; is the pattern
and &#39;bar&#39; is the replacement.</p>
<p>By default, <code>replace()</code> only replaces the first instance of the pattern. In
the below example, JavaScript only replaces the first instance of &#39;foo&#39; with &#39;bar&#39;.</p>
<pre><code class="lang-javascript"><span class="hljs-string">'foo foo'</span>.replace(<span class="hljs-string">'foo'</span>, <span class="hljs-string">'bar'</span>); <span class="hljs-comment">// 'bar foo'</span>
</code></pre>
<p>Unfortunately, in my experience it&#39;s rare you only want to replace the first instance
of a substring. To make JavaScript replace <em>all</em> instances of a substring rather than
just one, you need to use a regular expression.</p>
<h2 id="regexps-and-the-global-flag">RegExps and the <code>global</code> Flag</h2>
<p>To replace all instances of &#39;foo&#39; in a string, you need to use a
<a href="http://2ality.com/2013/08/regexp-g.html">regular expression with the <code>/g</code> flag</a>.</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// Note the 'g' after `/foo/`</span>
<span class="hljs-string">'foo foo'</span>.replace(<span class="hljs-regexp">/foo/g</span>, <span class="hljs-string">'bar'</span>); <span class="hljs-comment">// 'bar bar'</span>

<span class="hljs-comment">// Without 'g', `replace()` will only replace the first 'foo'</span>
<span class="hljs-string">'foo foo'</span>.replace(<span class="hljs-regexp">/foo/</span>, <span class="hljs-string">'bar'</span>); <span class="hljs-comment">// 'bar foo'</span>
</code></pre>
<p>Using the <code>/str/</code> syntax can be inconvenient if the string you want to replace
has slashes or special characters. In that case, you can use
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp">JavaScript&#39;s <code>RegExp</code> constructor</a>.</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// Pass 'g' as the 2nd argument to set the global flag</span>
<span class="hljs-keyword">const</span> re = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">'/home/user'</span>, <span class="hljs-string">'g'</span>);

<span class="hljs-string">'/home/user/path/to/file.txt'</span>.replace(re, <span class="hljs-string">'~'</span>); <span class="hljs-comment">// '~/path/to/file.txt'</span>

re.global; <span class="hljs-comment">// true</span>
</code></pre>
<p>If you want to make sanitize user input to make it safe to use with RegExps and
<code>.replace()</code>, you should use the <a href="https://www.npmjs.com/package/escape-string-regexp"><code>escape-string-regexp</code> package</a>.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> escapeString = <span class="hljs-built_in">require</span>(<span class="hljs-string">'escape-string-regexp'</span>);

<span class="hljs-comment">// Without escaping the string, `new RegExp('.*')` gives you a RegExp</span>
<span class="hljs-comment">// that matches any string, rather than just instances of '.*'.</span>
<span class="hljs-keyword">const</span> re = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(escapeString(<span class="hljs-string">'.*'</span>), <span class="hljs-string">'g'</span>);

<span class="hljs-string">'.* .*'</span>.replace(re, <span class="hljs-string">'foo'</span>); <span class="hljs-comment">// foo foo</span>
</code></pre>
<h2 id="replacement-patterns">Replacement Patterns</h2>
<p>There are several <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace#Specifying_a_string_as_a_parameter">special character sequences that you can use in the 2nd argument to <code>replace()</code></a>.
For example, suppose you want to wrap all numbers in a string in parentheses.
JavaScript replaces <code>$&amp;</code> in the replacement string with the matched string,
so you can wrap all numbers in parentheses as shown below. Note that JavaScript
does <strong>not</strong> treat the replacement string as a regular expression, so you don&#39;t
need to escape the parentheses.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> str = <span class="hljs-string">'Like example 1, example 2 also shows this pattern'</span>;

<span class="hljs-comment">// 'Like example (1), example (2) also shows this pattern'</span>
str.replace(<span class="hljs-regexp">/\d+/g</span>, <span class="hljs-string">'($&amp;)'</span>);
</code></pre>
<p>A slightly more tricky task is prefixing all numbers in a string with a dollar
sign &#39;$&#39;. Using <code>$$&amp;</code> as your replacement will <strong>not</strong> give you the right result.
You need to use <code>$$$&amp;</code> with 3 <code>$</code> characters.</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// Year over year revenue grew from $4M to $5M</span>
<span class="hljs-string">'Year over year revenue grew from 4M to 5M'</span>.replace(<span class="hljs-regexp">/\d+/g</span>, <span class="hljs-string">'$$$&amp;'</span>);
</code></pre>
<p>If you want to add a single <code>$</code> sign immediately before a replacement pattern,
you need to <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace#Specifying_a_string_as_a_parameter">escape it by using <code>$$</code></a>.
You <em>only</em> need to escape <code>$</code> if you&#39;re using it immediately before <code>$</code>, <code>&amp;</code>, <code>`</code>, <code>&#39;</code>. You also need to escape <code>$</code> if it immediately precedes a digit and you&#39;re using capture groups.
For example, you do <strong>not</strong> need to escape <code>$</code>
if the next character in the replacement is a space:</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// Year over year revenue grew from $ 4M to $ 5M</span>
<span class="hljs-string">'Year over year revenue grew from 4M to 5M'</span>.replace(<span class="hljs-regexp">/\d+/g</span>, <span class="hljs-string">'$ $&amp;'</span>);
</code></pre>
<h2 id="passing-a-function-as-the-replacement">Passing a Function as the Replacement</h2>
<p>You can get extra fancy and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace#Specifying_a_function_as_a_parameter">pass a function as the replacement</a>. JavaScript will call your replacement function for every
instance of the pattern, and replace with the return value of your replacement
function.</p>
<p>JavaScript calls your replacement function with 3 parameters <em>unless</em> you use a
<a href="https://javascript.info/regexp-groups#contents-of-parentheses">RegExp capture group</a>.
The 3 arguments are:</p>
<ul>
<li><code>name</code>: The substring matched by the pattern</li>
<li><code>offset</code>: The index of the start of <code>name</code> in the whole string</li>
<li><code>string</code>: The string you called <code>replace()</code> on.</li>
</ul>
<p>Here&#39;s an example:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> values = [<span class="hljs-string">'foo'</span>, <span class="hljs-string">'bar'</span>, <span class="hljs-string">'baz'</span>];

<span class="hljs-comment">// The below replaces '1 2 3' with 'foo bar baz'</span>
<span class="hljs-string">'1 2 3'</span>.replace(<span class="hljs-regexp">/\d+/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, offset, string</span>) </span>{
  <span class="hljs-comment">// This function is called 3 times</span>
  name; <span class="hljs-comment">// '1', '2', '3'</span>
  offset; <span class="hljs-comment">// 0, 2, 4</span>
  string; <span class="hljs-comment">// Always '1 2 3'</span>

  <span class="hljs-keyword">return</span> values[<span class="hljs-built_in">Number</span>(name) - <span class="hljs-number">1</span>]; <span class="hljs-comment">// return 'foo', 'bar', 'baz'</span>
});
</code></pre>
<h2 id="moving-on">Moving On</h2>
<p>Replacing substrings in JavaScript has some common pitfalls, most notably only
replacing only the first instance of the substring by default. But JavaScript
makes up for it with replacement patterns and replacement functions, which allow
for some powerful string manipulation patterns. Tricky tasks like prefixing
all numbers in a string with dollar signs become elegant one-liners. Try out
replacement patterns or replacement functions next time you&#39;re tempted to
chain together <code>.split().map().join()</code>.</p>
</div><div style="color: #666666; border-top: 1px dashed #666666; margin: 25px; text-align: center; padding-top: 10px"><em>Found a typo or error? Open up a pull request! This post is
available as markdown on&nbsp;<a href="https://github.com/vkarpov15/thecodebarbarian.com/blob/master/lib/posts/#{post.src.substr('./lib/posts/'.length)}">Github</a></em></div><div id="disqus_thread"></div><script type="text/javascript">/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'codebarbarian'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><a class="dsq-brlink" href="http://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a></div></div><div style="padding-bottom: 100px">&nbsp;</div><script type="text/javascript">var xhr = new XMLHttpRequest();
xhr.open('POST', 'https://g0a3nbw0xa.execute-api.us-east-1.amazonaws.com/prod/track', true);
xhr.setRequestHeader('Content-Type', 'application/json');
xhr.onreadystatechange = function() {};
xhr.send(JSON.stringify({
  path: window.location.pathname,
  hostname: window.location.hostname
}));</script><link rel="stylesheet" href="/style/inlinecpc.css"/></body></html>