<html><head><script type="text/javascript">var _sf_startpt=(new Date()).getTime()
</script><title>Testing AngularJS Directives | www.thecodebarbarian.com</title><meta name="viewport" content="width=device-width, initial-scale=1"/><link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" type="text/css"/><link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600" rel="stylesheet" type="text/css"/><link href="//fonts.googleapis.com/css?family=Merriweather:400,400italic,600,700" rel="stylesheet" type="text/css"/><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/><link href="/style/style.css" rel="stylesheet" type="text/css"/><link href="/style/github.css" rel="stylesheet" type="text/css"/><script href="http://code.jquery.com/jquery-2.1.1.min.js" type="text/javascript"></script><script href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js" type="text/javascript"></script><script href="/javascript/sidebar.js" type="text/javascript"></script><meta property="og:title" content="Testing AngularJS Directives"/><meta property="og:url" content="http://www.thecodebarbarian.com/2015/06/12/testing-angularjs-directives"/><meta property="og:image" content="http://i.imgur.com/beDSHUq.png"/><meta property="og:site_name" content="The Code Barbarian"/></head><body><div class="navbar social-links hidden-sm hidden-xs"><div class="container"><ul class="nav navbar-nav navbar-right"><li><a href="http://www.twitter.com/code_barbarian">twitter</a></li><li><a href="http://www.github.com/vkarpov15">github</a></li><li><a href="http://thecodebarbarian.com/feed.xml">rss</a></li><li><a href="/recommendations">recommendations</a></li></ul></div></div><div id="nav" class="navbar"><div class="container"><div class="navbar-header"><a href="http://thecodebarbarian.com" class="navbar-brand big-brand"><img src="/images/Barbarian_Head.png" class="logo"/><span class="site-name">The Code Barbarian</span></a></div><div id="home-nav-mobile" class="navbar-right collapse navbar-collapse"><ul class="nav navbar-nav"><li><a href="/tag/mongodb.html">MongoDB</a></li><li><a href="/tag/angularjs.html">AngularJS</a></li><li><a href="/tag/nodejs.html">NodeJS</a></li><li><a href="/tag/asyncawait.html">Async/Await</a></li><li class="hidden-md hidden-lg"><a href="#">@code_barbarian</a></li><li class="hidden-md hidden-lg"><a href="#">TCB Github</a></li><li class="hidden-md hidden-lg"><a href="#">TCB Facebook</a></li></ul></div></div></div><div class="container-fluid"><div id="desktop-right-bar" class="col-lg-3 col-lg-offset-9 right-bar"><div class="right-bar-content-slider pull-right"><div class="row recent-posts right-bar-group"><div class="col-lg-12 articles"><p class="right-bar-label">Most Popular Articles</p><ul class="list-unstyled"><li class="right-bar-li"><a href="/common-async-await-design-patterns-in-node.js.html">Common Async/Await Design Patterns in Node.js</a></li><li class="right-bar-li"><a href="/unhandled-promise-rejections-in-node.js.html">Unhandled Promise Rejections in Node.js</a></li><li class="right-bar-li"><a href="/using-async-await-with-mocha-express-and-mongoose">Using Async/Await with Mocha, Express, and Mongoose</a></li><li class="right-bar-li"><a href="/write-your-own-node-js-promise-library-from-scratch.html">Write Your Own Node.js Promise Library from Scratch</a></li><li class="right-bar-li"><a href="/80-20-guide-to-express-error-handling">The 80/20 Guide to Express Error Handling</a></li></ul></div></div><div class="row recent-posts right-bar-group"><div class="col-lg-12 books"><p class="right-bar-label">Ebooks<div><a href="http://asyncawait.net/?utm_source=thecodebarbarian&amp;utm_campaign=sidebar"><img src="/images/verticalbanner.png"/></a></div><div><a href="http://es2015generators.com"><img src="https://i.imgur.com/xvGNKlr.png"/><p><i>The 80/20 Guide to ES2015 Generators</i></p></a></div><div><script type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&amp;serve=C6AILKT&amp;placement=thecodebarbariancom" id="_carbonads_js"></script></div></p></div></div></div></div></div><div id="mobile-sharing-options" class="container-fluid hidden-sm hidden-md hidden-lg"><div class="row"><div class="col-lg-12"><style>#home-nav-mobile {
  float: left !important;
  margin-left: 215px !important;
}
</style><div class="post-sharing-options"><div class="row"><div class="col-xs-3 twitter-share sharing-option"><a href="https://twitter.com/share?url=http%3A%2F%2Fwww.thecodebarbarian.com%2F2015%2F06%2F12%2Ftesting-angularjs-directives&amp;via=code_barbarian" class="social"><i class="fa fa-twitter"></i></a></div><div class="col-xs-3 facebook-share sharing-option"><a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.thecodebarbarian.com%2F%2F2015%2F06%2F12%2Ftesting-angularjs-directives" class="social"><i class="fa fa-facebook"></i></a></div><div class="col-xs-3 google-share sharing-option"><a href="https://plus.google.com/share?url=http%3A%2F%2Fwww.thecodebarbarian.com%2F%2F2015%2F06%2F12%2Ftesting-angularjs-directives" class="social"><i class="fa fa-google-plus"></i></a></div><div class="col-xs-3 comment sharing-option"><a href="#disqus_thread" class="social"><i class="fa fa-comment"></i></a></div></div></div></div></div></div><div id="desktop-sharing-options" class="post-sharing-options hidden-xs pull-left"><ul class="list-unstyled"><li class="twitter-share"><a href="https://twitter.com/share?url=http%3A%2F%2Fwww.thecodebarbarian.com%2F2015%2F06%2F12%2Ftesting-angularjs-directives&amp;via=code_barbarian" class="social"><i class="fa fa-twitter sharing-option"></i></a></li><li class="facebook-share"><a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.thecodebarbarian.com%2F%2F2015%2F06%2F12%2Ftesting-angularjs-directives" class="social"><i class="fa fa-facebook sharing-option"></i></a></li><li class="google-share"><a href="https://plus.google.com/share?url=http%3A%2F%2Fwww.thecodebarbarian.com%2F%2F2015%2F06%2F12%2Ftesting-angularjs-directives" class="social"><i class="fa fa-google-plus sharing-option"></i></a></li></ul></div><div class="container"><div class="col-lg-9 post-text"><div class="row"><div class="title-byline-container"><h1 class="post-title">Testing AngularJS Directives</h1><div class="credits"><span class="byline">by Valeri Karpov</span><span class="byhandle"><a href="http://www.twitter.com/code_barbarian">@code_barbarian</a></span><span class="bydate">June 12, 2015</span></div></div></div><script type="text/javascript" src="/js/native.js"></script><div><script>
  _native.init("CK7DT53N",{
    targetClass: 'native-inline'
  });
</script>

<div class="native-inline">
  <a href="#native_link#"><span class="sponsor">Sponsor</span> #native_company# - #native_desc#</a>
</div>
</div><div class="post-body-text-container"><p>Strict unit tests are an interesting subject. They&#39;re simple, elegant, and do
a good job of explaining a block of code&#39;s assumptions. On the other hand,
nothing is more depressing than staying late at the office writing unit tests.
Furthermore, for a small, fast-moving startup, time spent writing unit tests
is time not spent working on bug fixes, implementing new features, and other
work that moves the needle on your business.</p>
<p>This is because adding a new feature usually involves adding new elements to
your UI, and unit tests won&#39;t cover actual DOM interactions. In AngularJS,
adding a new feature often corresponds to writing a new directive (in AngularJS
2, this&#39;ll correspond to adding a new component, which is conceptually the
same thing). In this article, I&#39;ll show how you can write DOM-level integration
tests for your directives using plain old mocha (no protractor or ngScenario)
and run them in the browser using <a href="http://thecodebarbarian.com/2015/05/08/testing-client-side-javascript-with-karma">Karma</a>.</p>
<h2 id="testing-a-trivial-directive">Testing a Trivial Directive</h2>
<p>Let&#39;s say you have one trivial directive that displays the number of times its
been clicked using an inline template.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> app = angular.module(<span class="hljs-string">'myApp'</span>, [<span class="hljs-string">'ng'</span>]);

app.directive(<span class="hljs-string">'counterDirective'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> {
    controller: <span class="hljs-string">'MyController'</span>,
    template: <span class="hljs-string">'&lt;div  ng-controller="MyController"'</span> +
              <span class="hljs-string">'      ng-click="counter = counter + 1"&gt;'</span> +
              <span class="hljs-string">'You\'ve clicked this div {{counter}} times'</span> +
              <span class="hljs-string">'&lt;/div&gt;'</span>
  }
});

app.controller(<span class="hljs-string">'MyController'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$scope</span>) </span>{
  $scope.counter = <span class="hljs-number">0</span>;
});
</code></pre>
<p>You can unit test <code>MyController</code>, but that&#39;s not particularly interesting. The
logic in the HTML is more complex than the logic in JavaScript, which is why
unit testing controllers in AngularJS often feels pedantic. Let&#39;s take this
<code>directive.js</code> file and test the actual HTML interactions. First, the Karma
config file. Note that you&#39;ll need to install the <code>karma-mocha</code>, <code>karma-chai</code>,
and <code>karma-chrome-launcher</code> npm packages for this config file to work properly.</p>
<p><strong>Shameless Plug:</strong> If you&#39;re not familiar with karma, check out
<a href="http://thecodebarbarian.com/2015/05/08/testing-client-side-javascript-with-karma">my guide to testing client-side JavaScript with karma</a></p>
<pre><code class="lang-javascript"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">config</span>) </span>{
  config.set({
    files: [
      <span class="hljs-string">'http://code.jquery.com/jquery-1.11.3.js'</span>,
      <span class="hljs-string">'https://ajax.googleapis.com/ajax/libs/angularjs/1.4.0/angular.js'</span>,
      <span class="hljs-string">'./directive.js'</span>,
      <span class="hljs-string">'./test.js'</span>
    ],
    frameworks: [<span class="hljs-string">'mocha'</span>, <span class="hljs-string">'chai'</span>],
    browsers: [<span class="hljs-string">'Chrome'</span>]
  });
};
</code></pre>
<p>Why jQuery? Because AngularJS&#39; internal jqLite implementation is <em>very</em>
light, so light it
<a href="https://docs.angularjs.org/api/ng/function/angular.element#angular-s-jqlite">doesn&#39;t include functions like <code>.click()</code></a>.
For tests like this, it helps to have the convenient jQuery <code>.click()</code> syntax.</p>
<p>Now, let&#39;s take a look at <code>test.js</code>. As mentioned previously, this is just plain
old mocha tests, no AngularJS-specific testing frameworks at all.</p>
<pre><code class="lang-javascript">describe(<span class="hljs-string">'counterDirective'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> injector;
  <span class="hljs-keyword">var</span> element;
  <span class="hljs-keyword">var</span> scope;

  beforeEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// Create a new dependency injector using the 'myApp' module</span>
    injector = angular.injector([<span class="hljs-string">'myApp'</span>]);

    injector.invoke(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$rootScope, $compile</span>) </span>{
      <span class="hljs-comment">// Get a new scope</span>
      scope = $rootScope.$<span class="hljs-keyword">new</span>();

      <span class="hljs-comment">// Compile some HTML that uses the directive</span>
      element = $compile(<span class="hljs-string">'&lt;counter-directive&gt;&lt;/counter-directive&gt;'</span>)(scope);
      scope.$apply();
    });
  });

  it(<span class="hljs-string">'increments counter when you click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    assert.equal(element.text(), <span class="hljs-string">'You\'ve clicked this div 0 times'</span>);
    element.find(<span class="hljs-string">'div'</span>).click();
    assert.equal(element.text(), <span class="hljs-string">'You\'ve clicked this div 1 times'</span>);
  });
});
</code></pre>
<p>As you can see, the test is pleasantly simple. Bootstrapping AngularJS to
compile the <code>counterDirective</code> HTML is straightforward, it&#39;s just not something
that the AngularJS docs make clear. All you need to do is create a new
dependency injector that uses your module, get the dependency injector&#39;s
<code>$compile</code> service, and compile some HTML that uses your directive. Once you
compile and attach a scope, you get back a nice jQuery-like element that you can
manipulate to your heart&#39;s content.</p>
<p>Since this code is meant to run through Karma, you can run it in a real browser.
This means that you can effectively TDD your way through
Internet-Explorer-specific bug fixes.</p>
<h2 id="adding-in-template-urls">Adding in Template URLs</h2>
<p>The above example is interesting, but how often do you actually inline HTML in
your directive definitions? Typically you&#39;re going to use <code>templateURL</code> and
load your templates as necessary from the server or a CDN. When you use
<code>templateURL</code>, you need a little extra work to make this test behave, because
the template will be loaded asynchronously. In order to know when the template&#39;s
been successfully loaded, your test is going to need a little extra help in the
form of a scope event.</p>
<p><strong>Note</strong> this code is a little hacky, but I haven&#39;t found a better way. I&#39;m open
to suggestions :)</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> app = angular.module(<span class="hljs-string">'myApp'</span>, [<span class="hljs-string">'ng'</span>]);

app.directive(<span class="hljs-string">'counterDirective'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> {
    controller: <span class="hljs-string">'MyController'</span>,
    templateUrl: <span class="hljs-string">'/directive.html'</span>
  }
});

app.controller(<span class="hljs-string">'MyController'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$scope</span>) </span>{
  $scope.counter = <span class="hljs-number">0</span>;

  <span class="hljs-comment">// Emit event **after** apply is done</span>
  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    $scope.$emit(<span class="hljs-string">'MyController'</span>);
  }, <span class="hljs-number">0</span>);
});
</code></pre>
<p><strong>Edit:</strong> In late 2015 I started using <a href="https://www.npmjs.com/package/gulp-html2js">gulp-html2js</a> to avoid the need for an event emitter. That module pre-populates your AngularJS template cache (see <a href="http://www.amazon.com/Professional-AngularJS-Valeri-Karpov/dp/1118832078">Professional AngularJS chapter 6</a>) so your tests don&#39;t have to make HTTP requests to get your templates.</p>
<p>The new <code>counterDirective</code> now uses a template loaded over HTTP,
<code>directive.html</code>. In order to make it possible for the tests to detect when
the directive template has been loaded, the <code>$emit()</code> call above runs
<em>after</em> the current <code>$apply()</code> loop, so the initial state of the directive
should be rendered when it fires.</p>
<p>Your test can then wait for the &#39;MyController&#39; event to start interacting
with the directive, using mocha&#39;s nice async testing functionality.</p>
<pre><code class="lang-javascript">describe(<span class="hljs-string">'counterDirective'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> injector;
  <span class="hljs-keyword">var</span> element;
  <span class="hljs-keyword">var</span> scope;

  beforeEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    injector = angular.injector([<span class="hljs-string">'myApp'</span>]);

    injector.invoke(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$rootScope, $compile</span>) </span>{
      scope = $rootScope.$<span class="hljs-keyword">new</span>();
      element = $compile(<span class="hljs-string">'&lt;counter-directive&gt;&lt;/counter-directive&gt;'</span>)(scope);
      scope.$apply();
    });
  });

  it(<span class="hljs-string">'increments counter when you click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">done</span>) </span>{
    scope.$on(<span class="hljs-string">'MyController'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      assert.equal(element.text().trim(), <span class="hljs-string">'You\'ve clicked this div 0 times'</span>);
      element.find(<span class="hljs-string">'div'</span>).click();
      assert.equal(element.text().trim(), <span class="hljs-string">'You\'ve clicked this div 1 times'</span>);
      done();
    });
  });
});
</code></pre>
<p>In order to get these tests to work, you also need to add a karma proxy to
make sure karma knows where <code>/directive.html</code> is:</p>
<pre><code class="lang-javascript"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">config</span>) </span>{
  config.set({
    files: [
      <span class="hljs-string">'http://code.jquery.com/jquery-1.11.3.js'</span>,
      <span class="hljs-string">'https://ajax.googleapis.com/ajax/libs/angularjs/1.4.0/angular.js'</span>,
      <span class="hljs-string">'./directive.js'</span>,
      <span class="hljs-string">'./test.js'</span>
    ],
    frameworks: [<span class="hljs-string">'mocha'</span>, <span class="hljs-string">'chai'</span>],
    browsers: [<span class="hljs-string">'Chrome'</span>],
    <span class="hljs-comment">// So the directive makes an HTTP request to the correct server</span>
    proxies: {
      <span class="hljs-string">'/'</span>: <span class="hljs-string">'http://localhost:3000'</span>
    }
  });
};
</code></pre>
<h2 id="testing-http-interactions">Testing HTTP Interactions</h2>
<p>Now you can test directives that use <code>templateUrl</code>, which covers a broad set of
directives already. The last part is testing directives that make HTTP calls.
Often your HTTP calls will be abstracted out behind services that you can stub
out. However, if you just want to abstract away the server, you can stub out
<code>$http</code> using the <code>$httpBackend</code> service and the <code>ngMockE2E</code> module.</p>
<p>Suppose you added a simple <code>$http</code> call to your directive&#39;s controller:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> app = angular.module(<span class="hljs-string">'myApp'</span>, [<span class="hljs-string">'ng'</span>]);

app.directive(<span class="hljs-string">'counterDirective'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> {
    controller: <span class="hljs-string">'MyController'</span>,
    templateUrl: <span class="hljs-string">'/directive.html'</span>
  }
});

app.controller(<span class="hljs-string">'MyController'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$scope, $http</span>) </span>{
  $scope.counter = <span class="hljs-number">0</span>;

  <span class="hljs-comment">// Make a silly HTTP request that does nothing</span>
  $http.get(<span class="hljs-string">'/'</span>).success(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) </span>{
    $scope.data = data;
  });

  <span class="hljs-comment">// Emit event **after** apply is done</span>
  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    $scope.$emit(<span class="hljs-string">'MyController'</span>);
  }, <span class="hljs-number">0</span>);
});
</code></pre>
<p>You need to add the <code>angular-routes.js</code> file to Karma, so you can use the
<code>ngMockE2E</code> module to stub out <code>$http</code> properly.</p>
<pre><code class="lang-javascript"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">config</span>) </span>{
  config.set({
    files: [
      <span class="hljs-string">'http://code.jquery.com/jquery-1.11.3.js'</span>,
      <span class="hljs-string">'https://ajax.googleapis.com/ajax/libs/angularjs/1.4.0/angular.js'</span>,
      <span class="hljs-comment">// For ngMockE2E</span>
      <span class="hljs-string">'https://ajax.googleapis.com/ajax/libs/angularjs/1.4.0/angular-mocks.js'</span>,
      <span class="hljs-string">'./directive.js'</span>,
      <span class="hljs-string">'./test.js'</span>
    ],
    frameworks: [<span class="hljs-string">'mocha'</span>, <span class="hljs-string">'chai'</span>],
    browsers: [<span class="hljs-string">'Chrome'</span>],
    proxies: {
      <span class="hljs-string">'/'</span>: <span class="hljs-string">'http://localhost:3000'</span>
    }
  });
};
</code></pre>
<p>And here&#39;s your new <code>test.js</code>:</p>
<pre><code class="lang-javascript">describe(<span class="hljs-string">'counterDirective'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> injector;
  <span class="hljs-keyword">var</span> element;
  <span class="hljs-keyword">var</span> scope;
  <span class="hljs-keyword">var</span> httpBackend;

  beforeEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// For $httpBackend, add 'ngMockE2E'</span>
    injector = angular.injector([<span class="hljs-string">'myApp'</span>, <span class="hljs-string">'ngMockE2E'</span>]);

    injector.invoke(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$rootScope, $compile, $httpBackend</span>) </span>{
      scope = $rootScope.$<span class="hljs-keyword">new</span>();

      <span class="hljs-comment">// Configure $httpBackend to allow us to access templates from server</span>
      httpBackend = $httpBackend;
      httpBackend.whenGET(<span class="hljs-string">'/directive.html'</span>).passThrough();

      element = $compile(<span class="hljs-string">'&lt;counter-directive&gt;&lt;/counter-directive&gt;'</span>)(scope);
      scope.$apply();
    });
  });

  it(<span class="hljs-string">'increments counter when you click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">done</span>) </span>{
    <span class="hljs-comment">// And configure $httpBackend to catch the 'GET /' HTTP request</span>
    httpBackend.expectGET(<span class="hljs-string">'/'</span>).respond({ ok: <span class="hljs-number">1</span> });

    scope.$on(<span class="hljs-string">'MyController'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      assert.equal(element.text().trim(), <span class="hljs-string">'You\'ve clicked this div 0 times'</span>);
      element.find(<span class="hljs-string">'div'</span>).click();
      assert.equal(element.text().trim(), <span class="hljs-string">'You\'ve clicked this div 1 times'</span>);

      <span class="hljs-comment">// Tell AngularJS to respond to the request so we can verify that we</span>
      <span class="hljs-comment">// handled the response properly.</span>
      httpBackend.flush();
      assert.strictEqual(scope.data.ok, <span class="hljs-number">1</span>);

      done();
    });
  });
});
</code></pre>
<h2 id="conclusion">Conclusion</h2>
<p>One of the key features of AngularJS is its powerful testing features. Because
of its structure, you can test AngularJS code at just about any level of
abstraction you want, from simple unit tests up to full end-to-end tests. In
this article, you learned how to test directives with DOM integration but
without the server component. This testing paradigm has some neat features.
Since it isn&#39;t dependent on server state, you can run tests across multiple
browsers in parallel. Since it relies on karma, you can run tests in real
browsers or in PhantomJS, depending on your needs. Most importantly, you&#39;re
testing real user interactions at the level of clicking on DOM elements, which
is awesome if you don&#39;t have the time to be pedantic about testing practices.</p>
<p><em>The sample code for this article is available on <a href="https://github.com/vkarpov15/thecodebarbarian.com/tree/master/bin/sample/20150612">this blog&#39;s GitHub repo</a></em></p>
<p><em>Like this article? Chapter 9 of my upcoming book,
<a href="http://www.amazon.com/Professional-AngularJS-Valeri-Karpov/dp/1118832078/">Professional AngularJS</a>,
is a detailed guide to testing AngularJS applications. It includes
more detail about using karma and ngScenario to test AngularJS
applications, as well as protractor.</em></p>
</div><div style="color: #666666; border-top: 1px dashed #666666; margin: 25px; text-align: center; padding-top: 10px"><em>Found a typo or error? Open up a pull request! This post is
available as markdown on&nbsp;<a href="https://github.com/vkarpov15/thecodebarbarian.com/blob/master/lib/posts/20150612_directive_testing.md">Github</a></em></div><div id="disqus_thread"></div><script type="text/javascript">/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'codebarbarian'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></div></div><div style="padding-bottom: 100px">&nbsp;</div><script type="text/javascript">var xhr = new XMLHttpRequest();
xhr.open('POST', 'https://g0a3nbw0xa.execute-api.us-east-1.amazonaws.com/prod/track', true);
xhr.setRequestHeader('Content-Type', 'application/json');
xhr.onreadystatechange = function() {};
xhr.send(JSON.stringify({
  path: window.location.pathname,
  hostname: window.location.hostname
}));</script><link rel="stylesheet" href="/style/inlinecpc.css"/></body></html>